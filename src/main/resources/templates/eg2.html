<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>右侧测试页面2</title>
	<link rel="stylesheet" href="/vue/vue-index.css">
	<script src="/vue/vue.js"></script>
	<link rel="stylesheet" href="/element/index.css">
	<script src="/vue/vue-index.js"></script>
	<script type="text/javascript" src="/vue/vue.js"></script>
	<script src="https://cdn.bootcss.com/axios/0.19.0-beta.1/axios.js"></script>
	<!-- 引入样式 -->
	<link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
	<!-- 引入组件库 -->
	<script src="https://unpkg.com/element-ui/lib/index.js"></script>
	<!--<style>
		.el-row {
			margin-bottom: 20px;
		}
		.bg-purple{
			background: #d3dce6;
		}
	
	</style>-->

</head>
<body>
<div id="app1">
	<!--
	<el-row>
		<el-table
				:data="tableData"
				v-loading.body="loading"
				border
				@selection-change="selectionChange"
				style="width: 100%">
			<el-table-column
					type="selection"
					width="55">
			</el-table-column>
			<el-table-column
					prop="ID"
					label="id"
					width="120">
			</el-table-column>
			<el-table-column
					prop="NAME"
					label="姓名"
					width="105">
			</el-table-column>
			<el-table-column
					prop="SEX"
					label="性别"
					width="150">
			</el-table-column>
			<el-table-column
					prop="AGE"
					label="年龄"
					width="150">
			</el-table-column>
			<el-table-column
					prop="NUMBERINFO"
					label="手机号"
					width="120">
			</el-table-column>
			<el-table-column
					prop="REMARK"
					label="备注"
					width="120">
			</el-table-column>
			
			<el-table-column
					label="操作">
				<template scope="scope">
					<el-button :plain="true" type="success" size="small" icon="edit" @click="editClick(scope.row)">编辑
					</el-button>
					<el-button :plain="true" type="danger" size="small" icon="delete" @click="deleteClick(scope.row)">
						删除
					</el-button>
				</template>
			</el-table-column>
		</el-table>
	</el-row>
	
	&lt;!&ndash;编辑界面&ndash;&gt;
	<el-dialog title="编辑" :visible.sync="editFormVisible" :close-on-click-modal="false">
		<el-form :model="editForm" label-width="80px" :rules="editFormRules" ref="editForm">
			<el-form-item label="id">
				<el-input v-model="editForm.ID" auto-complete="off"></el-input>
			</el-form-item>
			<el-form-item label="姓名" prop="name">
				<el-input v-model="editForm.NAME" auto-complete="off"></el-input>
			</el-form-item>
			<el-form-item label="性别">
				<el-input v-model="editForm.SEX"></el-input>
			</el-form-item>
			<el-form-item label="年龄">
				<el-input v-model="editForm.AGE"></el-input>
			</el-form-item>
			<el-form-item label="手机号">
				<el-input v-model="editForm.NUMBERINFO"></el-input>
			</el-form-item>
			<el-form-item label="说明">
				<el-input v-model="editForm.REMARK"></el-input>
			</el-form-item>
		</el-form>
		<div slot="footer" class="dialog-footer">
			<el-button @click.native="editFormVisible = false">取消</el-button>
			<el-button type="primary" @click.native="editSubmit" :loading="editLoading">提交</el-button>
		</div>
	</el-dialog>-->
	
	<!--upload-->
	<el-upload
			class="upload-demo"
			ref="upload"
			drag
			:action="api.addImg"
			:auto-upload="false"
			list-type="picture"
			:on-error="uploadError"
			:on-success="uploadSuccess"
			:limit="1"
	>
		
		<i class="el-icon-upload"></i>
		<div class="el-upload__text">将文件拖到此处，或<em>点击上传</em></div>
		<div class="el-upload__tip" slot="tip">只能上传jpg/png文件，且不超过500kb</div>
	</el-upload>
	<el-button style="margin-left: 10px;" size="small" type="success" @click="submitUpload">上传到服务器</el-button>
	
</div>
<script>
	/*upload*/
	let vue = new Vue({
		el: "#app1",
		data: {
			api: {addImg:"/user/addImg"}
		},

		methods: {
			submitUpload: function () {
				this.$refs.upload.submit();
			},
			uploadSuccess: function (response, file, fileList) {
				/*console.log("上传文件成功response" + response);
				console.log("上传文件成功file" + file);
				console.log("上传文件成功fileList" + fileList);
				// response：即为后端传来的数据，这里我返回的是图片的路径
				// app1.user.userImage = response;
				console.log(response)*/
				this.$refs.upload.clearFiles()
				this.$message({
					message: '上传成功',
					type: 'success'
				});
				
			},
			uploadError: function (response, file, fileList) {
				/*console.log("上传文件失败response" + response);
				console.log("上传文件失败file" + file);
				console.log("上传文件失败fileList" + fileList);*/
				this.$message.error('上传失败,可能是文件有点大,换个姿势再来一次吧');
			}
		}
	})
	/*增删改查*/
	/*new Vue({
		el: "#app1",
		data: {
			//列表数据
			tableData: [],
			//显示加载中样式
			loading: false,
			//删除的弹出框
			deleteVisible: false,
			//多选值
			multipleSelection: [],
			//编辑界面是否显示
			editFormVisible: false,
			editLoading: false,
			goUrl: '',
			editFormRules: {
				name: [
					{required: true, message: '请输入姓名', trigger: 'blur'}
				]
			},
			//编辑界面数据
			editForm: {
				ID: 0,
				NAME: '',
				SEX: 0,
				AGE:0,
				NUMBERINFO: 0,
				REMARK: ''
			},
		},
		created() {
			//在 then的内部不能使用Vue的实例化的this, 因为在内部 this 没有被绑定。
			let self = this;
			axios.post('/getTestList').then(function (response) {
				// console.log(response.data);
				self.tableData = response.data;
			})
		},
		methods: {
			//表格重新加载数据
			loadingData() {
				var _self = this;
				_self.loading = true;
				var self = this;
				// var start =(this.currentPage-1)*this.pageSize;
				// var end =this.currentPage*this.pageSize+1;
				// var searchForm={'start':start,'end':end,'id':this.searchForm.id,'name':this.searchForm.name,'deptNo':this.searchForm.deptNo};
				axios.post('/getTestList').then(function(response){
					// _self.total=response.data.total;
					_self.tableData = response.data;
				})
				setTimeout(function(){
					console.info("加载数据成功");
					_self.loading = false;
				},300);
			},
			//表格勾选事件
			selectionChange(val) {
				this.multipleSelection = val;
				console.info(val);
			},
			editClick(row) {
				this.goUrl = "/updateTest";
				this.editFormVisible = true;
				this.editForm = Object.assign({}, row);
			},
			//表格删除事件
			deleteClick(row) {
				/!*let _self = this;
				this.$confirm('确认删除' + row.name + '吗?', '提示', {
					type: 'warning'
				}).then(function () {
					let url = "/emp/del/" + row.name;
					axios.get(url).then(function (response) {
						//alert(response.data);
						if (response.data > 0) {
							_self.$message({
								message: row.name + '删除成功',
								type: 'success'
							});
							_self.loadingData();//重新加载数据
						}
					});
				}).catch(function (e) {
					if (e != "cancel")
						console.log("出现错误：" + e);
				});*!/
			},
			//保存点击事件
			editSubmit(){
				var _self = this;
				_self.loading = true;
				var formData =this.editForm;
				// alert(formData);
				var goUrl=this.goUrl;
				// alert(goUrl);
				// alert(JSON.stringify(formData));
				axios.post(goUrl,formData).then(function(response){
					console.log(response.data);
					// alert(222);
					// self.total=response.data.total;
					if(response.data>0){
						_self.editFormVisible = false;// 让弹出层隐藏
						_self.loadingData();//重新加载数据
					}
				})
				console.info(this.editForm);
			}
		}
	})*/

</script>
</body>
</html>